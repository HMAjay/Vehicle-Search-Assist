<!DOCTYPE html>
<html>
<head>
  <title>Welcome</title>
</head>
<body>

  <h2 id="welcomeText"></h2>

  <button onclick="logout()">Logout</button>

  <hr>

  <h3>Know about a vehicle</h3>

  <label>Vehicle Number:</label>
  <input id="vehicleNumber" placeholder="Enter Vehicle Number">
  <button onclick="searchVehicle()">VIEW</button>

  <script>
    // üîê Check login
    const user = JSON.parse(localStorage.getItem("user"));

    if (!user) {
      alert("Please login first");
      window.location.href = "login.html";
    } else {
      document.getElementById("welcomeText").innerText = 
        "Welcome " + user.name;
    }

    // üö™ Logout
    function logout() {
      localStorage.removeItem("user");
      window.location.href = "login.html";
    }

    // üîç Search Vehicle
    async function searchVehicle() {
      const vnum = document.getElementById("vehicleNumber").value;

      if (!vnum) {
        alert("Enter vehicle number");
        return;
      }

      const res = await fetch(`http://localhost:3000/vehicles/${vnum}`);

      if (!res.ok) {
        alert("Vehicle not found");
        return;
      }

      const data = await res.json();

      // Store vehicle info temporarily
      localStorage.setItem("vehicleData", JSON.stringify(data));

      // Move to view page
      window.location.href = "view.html";
    }
  </script>

</body>
</html>
